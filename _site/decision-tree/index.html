<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>决策树 &#8211; Shiyuan's blog</title>
<meta name="description" content="Loser">
<meta name="keywords" content="learning">


<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="决策树">
<meta property="og:description" content="Loser">
<meta property="og:url" content="/decision-tree/">
<meta property="og:site_name" content="Shiyuan's blog">



<link rel="canonical" href="/decision-tree/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Shiyuan's blog Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.min.css">
<!-- Webfonts -->
<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">



</head>

<body id="page" >

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="/">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="/images/avatar.jpg" alt="Shi Yuan photo" class="author-photo">
					<h4>Shi Yuan</h4>
					<p>Trapped in the past, I just can't seem to move on</p>
				</li>
				<li><a href="/about/">Learn More</a></li>
				<li>
					<a href="mailto:shiyuan404@hotmail.com"><i class="fa fa-envelope"></i> Email</a>
				</li>
				
				<li>
					<a href="http://facebook.com/yuan.shi.7393"><i class="fa fa-facebook"></i> Facebook</a>
				</li>
				
				
				<li>
					<a href="http://github.com/shiyuan"><i class="fa fa-github"></i> GitHub</a>
				</li>
				
				
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
		    <a href="/learning">learning</a>
		</li>
                <li> 
                     <a href="#">Life</a>
                     <ul class="dl-submenu">
                          <li>
                             <a href="/college-life">CCNU</a>
			  </li>
                          <li>
                             <a href="/now">now</a>
                          </li>
                     </ul>
                </li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="/posts/">All Posts</a></li>
				<li><a href="/tags/">All Tags</a></li>
			</ul>
		</li>
		<li><a href="http://blog.csdn.net/shiyuankongbu" target="_blank">CSDN</a></li><li><a href="http://wpa.qq.com/msgrd?v=3&uin=565099505&site=qq&menu=yes"" target="_blank">QQ</a></li>
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->




<div id="main" role="main">
  <article class="entry">
    <header class="header-title">
      <div class="header-title-wrap">
        <h1 class="entry-title">决策树</h1>
        
      </div><!-- /.header-title-wrap -->
    </header>
    <div class="entry-content">
      <p>Description:</p>

<p>学习笔记：<a href="/tjxxff">《统计学习方法笔记》</a>第五章 决策树</p>

<p><br></p>

<h3>1、决策树的模型和学习</h3>

<p>决策树：对实例的某一特征进行测试，根据测试结果将实例分配到其子节点，得到一个与训练数据矛盾较小的树形结构，本质是从数据集中归纳出一组分类规则。  <br/>
熵是表示随机变量不确定性的度量。设X是一个取有限个值的离散随机变量，其概率分布为：  <br/>
$$
P(X=x_i)=p_i , i=1,2,...,n
$$
则X的熵定义为：  <br/>
$$
H(x)=-\sum_{i=1}^{n} p_i \log p_i
$$</p>

<p>例 \(P(X=1)=p,P(X=0)=1-p,0&lt;=p&lt;=1\)时：  <br/>
$$
H(p)=-p \log_2 p - (1-p) \log_2 (1-p)
$$
熵\(H(p)\)随概率\(p\)的变化曲线在\(p=0.5\)的时候取最大值，不确定性最大，\(p=0\)或\(p=1\)的时候完全没有确定性。  <br/>
设有随机变量(X,Y),其联合概率分布为：  <br/>
$$
P(X=x_i,Y=y_j)=p_{ij} , i=1,2,...,n; j=1,2,...,m
$$</p>

<p>条件熵\(H(Y|X)\)表示在已知变量\(X\)的条件下随机变量\(Y\)的不确定性，定义为\(Y\)在条件\(X\)下的条件概率分布的熵对\(X\)的数学期望：</p>

<p>$$
H(Y|X)=\sum_{i=1}^{n} p_i H(Y|X=x_i) , i=1,2,...,n
$$</p>

<p>互信息：特征\(A\)对训练数据\(D\)的信息增益\(g(D,A)\)定义为集合D的经验熵与特征\(A\)给定条件下\(D\)的经验条件熵之差，即：  <br/>
$$
g(D,A)=H(D)-H(D|A)
$$</p>

<p>信息增益的算法：  <br/>
计算特征\(A\)对数据集\(D\)的经验条件熵：</p>

<p>$$
H(D|A)= \sum_{i=1}^{n} \frac{|D_i|}{|D|}H(D_i) = - \sum_{i=1}^{n} \frac{|D_i|}{|D|} \sum_{k=1}^{K} \frac{|D_{ik}|}{|D_i|} \log_2 \frac{|D_{ik}|}{|D_i|}
$$</p>

<p>信息增益比：  <br/>
$$
g_R(D,A)= \frac{g(D,A)}{H_A(D)}=\frac{H(D)-H(D|A)}{H_A(D)}
$$</p>

<p><br></p>

<h3>2.决策树的生成和剪枝</h3>

<p>\(ID3\)算法：相当于用极大似然估计进行概率模型的选择，对节点计算所有特征的信息增益，选择信息增益最大的特征作为节点特征，然后递归构建下一个节点  <br/>
\(C4.5\)算法：对\(ID3\)算法进行改进，每次选取增益比最大的特征作为节点，增益比小于阈值时递归结束  <br/>
极小化决策树函数的损失函数：</p>

<p>$$
C_a(T)=\sum_{t=1}^{|T|}N_tH_t(T)+\alpha|T|=-\sum_{t=1}^{|T|}\sum_{k=1}^{K}N_{tk}\log\frac{N_tk}{N_t}+\alpha|T|
$$</p>

<p>\(\alpha\)的取值决定了构建决策树的复杂度，\(\alpha\)取值越大，决策树的熵应越小，模型越简单，\(\alpha\)取值越小，对应模型越复杂，但是更容易过拟合  <br/>
剪枝：选择损失函数最小的模型。  <br/>
算法：确定\(\alpha\)后，从叶节点往上递归，若 \(C_{\alpha}(T')\geq C_{\alpha}(T_{father}')\) 则删掉当前节点，令其父节点为新的叶节点</p>

<p><br></p>

<h3>3.CART算法</h3>

<p>Classification and regression tree</p>

<p>1.回归树的生成  <br/>
假设输入空间划分为\(M\)个单元，并且在每个单元\(R_m\)上都有固定输出\(c_m\),回归树模型定义为：  <br/>
$$
f(x)=\sum_{m=1}^{M}c_mI(x \in R_m)
$$</p>

<p>单元\(R_m\)上的\(c_m\)的最优值\(\hat{c}_m\)是\(R\)上所有实例输出的均值：</p>

<p>$$
\hat{c}_m=ave(y_i|x_i \in R_m)
$$  <br/>
那么我们需要怎样的划分输入空间呢，我们假设选择第\(j\)个变量和它的取值\(s\)作为切分变量和切分点，于是可以得到两个空间\( R_1(j,s)=\{x|x \leq s\}，R_2(j,s)=\{x|x>s\}\)  <br/>
然后我们要怎么选取\(j\)和\(s\)呢，平方误差最小化：</p>

<p>$$
\min_{j,s}[\min_{c_1}\sum_{x_i \in R_1(j,s)}(y_i-c_i)^{2}+\min_{c_2}\sum_{x_i \in R_2(j,s)}(y_i-c_i)^{2}]
$$</p>

<p>算法：遍历所有的\(j\)，找到最优的 (\(j\),\(s\))，划分区域，反复</p>

<p>2.分类树的生成  <br/>
基尼指数定义为：</p>

<p>$$
Gini(p)=\sum_{k=1}^{K}p_k(1-p_k)=1-\sum_{k=1}^{K}p_k^{2}
$$</p>

<p>如果样本集合\(D\)根据特征\(A\)被分割为\(D=D_1+D_2\)(之所以分类树是二叉树而不是多叉树，是因为前面切分之后得到了两个空间，所以这里根据特征分类没必要扩展到\(N_A\)种特征)，那么在特征\(A\)的条件下集合\(D\)的基尼指数为：  <br/>
$$
Gini(D,A)=\frac{|D_1|}{|D|} Gini(D_1)+\frac{|D_2|}{|D|} Gini(D_2)
$$  <br/>
\(Gini(D)\)表示\(D\)的不确定性，\(Gini(D,A)\)表示集合\(D\)在特征\(A\)的分割下的不确定性</p>

<p>\(CART\) 生成算法：  <br/>
计算训练数据集\(D\)对所有特征\(A\)下的基尼指数，在所有特征\(A\)和切分点\(a\)中选出最优特征和最优切分点，生成子节点，反复。</p>

<p>\(CART\) 剪枝：  <br/>
子树的损失函数为：\( C_{\alpha}(T)=C(T)+\alpha|T| \)，对于固定的 \(\alpha\)一定存在使损失函数最小的子树 \(T_{\alpha}\)，如果最优子树是唯一的，那么\(\alpha\) 越大的时候，\(T_{\alpha}\)越小。极限情况，\(\alpha\)为0，整体树最优；\( \alpha \to \infty\)时，根节点组成的单节点树最优。  <br/>
从整体树 \(T_0\) 开始剪枝，对 \(T_0\) 内的任意节点 \(t\)，以 \(t\) 为单节点树的损失函数是 \( C_{\alpha}(t)=C(t)+\alpha \)，以  \(t\) 为根节点的子树 \(T_t\)损失函数为：\(C_{\alpha}(T_t)=C(T_t)+\alpha|T_t|\).  <br/>
当 \(\alpha=0\) 及 \(\alpha\)充分小时，有 \( C_{\alpha}(T_t) &lt; C_{\alpha}(t)\)  <br/>
当 \(\alpha \) 增大时，存在一个 \(\alpha\) 使得 \(C_{\alpha}(T_t) = C_{\alpha}(t)\)  <br/>
当 \(\alpha \) 继续增大时，\( C_{\alpha}(T_t) > C_{\alpha}(t)\)  <br/>
那么使 \( \alpha = \frac{C(t)-C(T_t)}{|T_t|-1} \)， \(t\) 比 \(T_t\)更可取，对 \(T_t\) 进行剪枝  <br/>
算法：初始 \(\alpha=+\infty\);自上而下访问所有子节点，\(\alpha=min(\alpha,\frac{C(t)-C(T_t)}{|T_t|-1})\)，如果有\(g(t)=\alpha\)进行剪枝，并对其以多数表决法决定该叶节点的类  <br/>
<br></p>

      <footer class="entry-meta">
        
        
      </footer>

<!-- 多说评论框 start -->
        <div class="ds-thread" data-thread-key="" data-title="决策树" data-url=""></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"shiyuan404"};
        (function() {
                var ds = document.createElement('script');
                ds.type = 'text/javascript';ds.async = true;
                ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
                ds.charset = 'UTF-8';
                (document.getElementsByTagName('head')[0]
                 || document.getElementsByTagName('body')[0]).appendChild(ds);
        })();
        </script>
<!-- 多说公共JS代码 end -->


    </div><!-- /.entry-content -->
    
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2015 Shi Yuan. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/hpstr/">HPSTR Theme</a>.</span>

  </footer>
</div><!-- /.footer-wrapper -->

<script>window.jQuery || document.write('<script src="../assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="../assets/js/scripts.min.js"></script>
          

</body>
</html>
